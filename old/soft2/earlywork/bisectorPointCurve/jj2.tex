\documentstyle[12pt]{article}

\begin{document}

\newcommand{\single}{\def\baselinestretch{1.0}\large\normalsize}
\newcommand{\double}{\def\baselinestretch{1.5}\large\normalsize}
\newcommand{\triple}{\def\baselinestretch{2.2}\large\normalsize}

\newcommand{\rd}{{\rm d}}
\newcommand{\re}{{\rm e}}
\newcommand{\ri}{{\rm i}}
\newcommand{\sgn}{{\rm sign}}
\newcommand{\half}{\textstyle{1 \over 2}\displaystyle}
\newcommand{\quarter}{\textstyle{1 \over 4}\displaystyle}
\newcommand{\dist}{{\rm distance}}
\newcommand{\cross}{\!\times\!}
\newcommand{\dotpr}{\!\cdot\!}
\newcommand{\vhat}{\hat {\bf v}}
\newcommand{\what}{\hat {\bf w}}
\newcommand{\zhat}{\hat {\bf z}}
\newcommand{\ldash}{\vrule height 3pt width 0.35in depth -2.5pt}
\newcommand{\be}{\begin{equation}}
\newcommand{\ee}{\end{equation}}
\newcommand{\ba}{\begin{eqnarray}}
\newcommand{\ea}{\end{eqnarray}}
\newcommand{\seg}[1]{\mbox{$\overline{#1}$}}

\newtheorem{dfn}{Definition}[section]
\newtheorem{rmk}{Remark}[section]
\newtheorem{lma}{Lemma}[section]
\newtheorem{propn}{Proposition}[section]
\newtheorem{exmpl}{Example}[section]
\newtheorem{conjec}{Conjecture}[section]
\newtheorem{claim}{Claim}[section]
\newtheorem{notn}{Notation}[section]
\newtheorem{thm}{Theorem}[section]
\newtheorem{crlry}{Corollary}[section]

\newcommand{\prf}{\noindent{{\bf Proof} :\ }}
\newcommand{\QED}{\vrule height 1.4ex width 1.0ex depth -.1ex\ \medskip}

\newcommand{\ACMTOG}{{\sl ACM Trans.\ Graph.\ }}
\newcommand{\AMM}{{\sl Amer.\ Math.\ Monthly\ }}
\newcommand{\BIT}{{\sl BIT\ }}
\newcommand{\CACM}{{\sl Commun.\ ACM\ }}
\newcommand{\CAD}{{\sl Comput.\ Aided Design\ }}
\newcommand{\CAGD}{{\sl Comput.\ Aided Geom.\ Design\ }}
\newcommand{\CJ}{{\sl Computer\ J.\ }}
\newcommand{\DCG}{{\sl Discrete\ Comput.\ Geom.\ }}
\newcommand{\IBMJRD}{{\sl IBM\ J.\ Res.\ Develop.\ }}
\newcommand{\IEEECGA}{{\sl IEEE Comput.\ Graph.\ Applic.\ }}
\newcommand{\IEEETPAMI}{{\sl IEEE Trans.\ Pattern Anal.\ Machine Intell.\ }}
\newcommand{\JACM}{{\sl J.\ Assoc.\ Comput.\ Mach.\ }}
\newcommand{\JAT}{{\sl J.\ Approx.\ Theory\ }}
\newcommand{\MC}{{\sl Math.\ Comp.\ }}
\newcommand{\MI}{{\sl Math.\ Intelligencer\ }}
\newcommand{\NM}{{\sl Numer.\ Math.\ }}
\newcommand{\SIAMJNA}{{\sl SIAM J.\ Numer.\ Anal.\ }}
\newcommand{\SIAMR}{{\sl SIAM Review\ }}

\newcommand{\figg}[3]{\begin{figure}[htbp]\vspace{#3}\caption{#2}\label{#1}\end{figure}}


\pagenumbering{roman}

\title{
The bisector of a point \\
and a plane parametric curve
}

\author{
Rida~T.~Farouki \\
IBM Thomas~J.~Watson Research Center, \\
P.~O.~Box 218, Yorktown Heights, NY 10598. \\ \\
John~K.~Johnstone \\
Department of Computer Science, \\
The Johns Hopkins University, Baltimore, MD 21218.
}

\maketitle

\begin{abstract}
The {\it bisector\/} of a point ${\bf p}$ and a smooth plane curve
$C$ --- i.e., the locus traced by a point that remains equidistant
with respect to ${\bf p}$ and $C$ --- is investigated in the case
that $C$ admits a regular polynomial or rational parameterization.
The bisector of ${\bf p}$ and any segment of $C$ can also be computed.
It is shown that the bisector may be regarded as (a
subset of) a ``variable--distance offset'' curve to $C$ which has
the remarkable property, unlike fixed--distance offsets, of being
{\it generically\/} a rational curve. The parametric subsegments
that constitute the true bisector are identified by a ``trimming''
procedure which requires only the ability to isolate and approximate
the real roots of certain polynomials to a prescribed accuracy.
Finally, the irregular points of the bisector curve are analyzed
and are shown to fall into certain well--defined categories.
\end{abstract}

\thispagestyle{empty}\mbox{}\vfill\eject

\pagenumbering{arabic}
\setcounter{page}{1}
\thispagestyle{plain}

\section{Introduction}
\label{intro}

In descriptive geometry \cite{coxeter69} the parabola is
characterized as the locus traced by a point that remains
equidistant with respect to a fixed point ${\bf p}$ (the
{\it focus\/}) and a given straight line $L$ (the {\it
directrix\/}). Thus, points of the plane that lie to one
side of the parabola are closer to ${\bf p}$ than to $L$,
while those that lie on the other side are closer to $L$
than to ${\bf p}$. In this sense, the parabola may be
regarded as the ``bisector'' of the point ${\bf p}$ and
the line $L$.

If we substitute a smooth plane curve $C$ in place of
the straight line $L$, the bisector locus is of a more
subtle nature. This paper is concerned with investigating
the geometric properties of such loci, and formulating
tractable representations for them. Point/curve bisectors
arise in a variety of geometric ``reasoning'' and geometric
decomposition problems (e.g., planning paths of maximum
clearance in robotics or computing Voronoi diagrams for areas
with curvilinear boundaries). Although simpler than other
loci --- line/curve and curve/curve bisectors --- that arise
in these contexts, point/curve bisectors have not attracted
much attention in the literature (see, however, \cite
{yap87,yap89}).

\subsection{Regular parametric curves}

We shall focus here on the important case where the curve $C$
is described parametrically, ${\bf r}(u)=\{x(u),y(u)\}$, having
derivatives
\be \label{derivs}
{\bf r}'(u) = \{x'(u),y'(u)\} \,, \quad
{\bf r}''(u) = \{x''(u),y''(u)\} \,, \quad
\ldots {\rm etc.}
\ee
continuous to at least third order for all $u \in I$, where $I$
denotes some finite, semi--infinite, or infinite parameter domain
of interest. We assume that the parameterization of ${\bf r}(u)$
is {\it proper}, i.e., there is a one--to--one correspondence
between parameter values $u$ and points $(x,y)$ of the curve
locus --- except, possibly, for finitely many instances where
${\bf r}(u)$ crosses itself.

Since improper parameterizations arise rather infrequently in
practice, and identifying them is not in general a straightforward
matter (see \cite{sederberg84,sederberg86}), we shall not dwell on
this issue. However, we do need to impose an additional constraint
on the parameterization of ${\bf r}(u)$ --- namely that it be {\it
regular\/} over the parameter domain of interest:

\begin{dfn}
The parametric speed of ${\bf r}(u)=\{x(u),y(u)\}$ is the
function
\be \label{sigma}
\sigma(u) = \sqrt{x'^2(u)+y'^2(u)}
\ee
of the parameter $u$, and the curve is said to have a {\it
regular\/} parameterization on the interval $I$ if and only if
$\sigma(u)\not=0$ for all $u \in I$.
\end{dfn}

It should be noted that any polynomial or rational curve that
has an irregular parameterization will not, in general, exhibit
a smooth locus: the points where $\sigma(u)=0$ correspond to
{\it cusps\/} (sudden tangent reversals or, exceptionally,
discontinuities in higher--order differential characteristics
\cite{farouki91b}).

We denote by $|{\bf v}|$ the Euclidean norm $\sqrt{v_x^2+
v_y^2}$ of a vector ${\bf v}=(v_x,v_y)$. Thus, we shall also
write $|{\bf r}'(u)|$ for the parametric speed of ${\bf r}(u)$,
to suit the context. Since we are concerned solely with {\it
real\/} functions $x(u)$ and $y(u)$ of a {\it real\/} parameter
$u$, we note that $\sigma(u)=0\;\Longleftrightarrow\;x'(u)=
y'(u)=0$.

Although much of the ensuing discussion holds for any regular
parametric curve, we shall deal primarily with the two functional
forms encountered most often in practice: the {\it polynomial\/}
curve ${\bf r}(u)=\{X(u),Y(u)\}$ of degree $n$ defined by
\be \label{polycurve}
X(u) = \sum_{k=0}^n a_k u^k \,, \quad
Y(u) = \sum_{k=0}^n b_k u^k \,,
\ee
the coefficients $\{a_k,b_k\}$ being real numbers that satisfy
$a_n^2+b_n^2\not=0$, and the {\it rational\/} curve ${\bf r}(u)=
\{X(u)/W(u),Y(u)/W(u)\}$ of degree $n$, where
\be \label{ratcurve}
X(u) = \sum_{k=0}^n a_k u^k \,, \quad
Y(u) = \sum_{k=0}^n b_k u^k \,, \quad
W(u) = \sum_{k=0}^n c_k u^k \,,
\ee
the coefficients $\{a_k,b_k,c_k\}$ being again real numbers
with either $a_n^2+b_n^2\not=0$ or $c_n\not=0$. In (\ref
{ratcurve}) we also assume that there are no factors common
to {\it all three\/} of the polynomials $X,Y,W$, i.e., that
${\rm GCD}(X,Y,W) ={\rm constant}$. (${\rm GCD}(\ldots)$
denotes the ``greatest common divisor'' of the indicated set
of polynomials, as determined by one or more applications of
Euclid's algorithm \cite{uspensky48}.)

Since polynomial curves are a special class of rational
curves with $W(u)={\rm constant}$, when we speak specifically
of rational curves it will be understood implicitly that $W(u)
\not={\rm constant}$. Roots of the polynomial $W(u)$ correspond
to ``points at infinity'' on the rational curve (\ref{ratcurve}).
In most applications, we are concerned only with the {\it affine\/}
part of a rational curve, i.e., its locus for all parameter values
$u$ such that $W(u)\not=0$.

\begin{rmk}
{\rm
A sufficient and necessary condition for the polynomial curve
$(\ref{polycurve})$ to have a regular parameterization is that
\be \label{regpoly}
{\rm GCD}(X',Y')={\rm constant} \,,
\ee
while in the case of the rational curve $(\ref{ratcurve})$ we
require
\be \label{regrat}
{{\rm GCD}(WX'-W'X,WY'-W'Y) \over {\rm GCD}(W,W')}={\rm constant}
\ee
for the affine locus to have a regular parameterization.
}
\end{rmk}

\begin{exmpl}
{\rm
We have already noted the simple nature of the bisector of a point
and a straight line. Another common case that yields an ``elementary''
bisector arises if we take the curve $C$ to be a {\it circle}. Assume,
without loss of generality, that $C$ is of unit radius and centered
on the origin, and let the given point be ${\bf p}=(\alpha,\beta)$.
Then the bisector is evidently the locus of points $(x,y)$ that
satisfy
\be
|\,\sqrt{x^2+y^2}-1\,| \,=\,
\sqrt{(\alpha-x)^2+(\beta-y)^2} \,,
\ee
where the left-- and right--hand sides represent the distance of
the variable point $(x,y)$ from the circle $C$ and the fixed point
${\bf p}$, respectively. Squaring twice to clear radicals, we see
that the bisector has the implicit equation
\ba \label{ellipse}
& & (1-\alpha^2)\,x^2 \,+\, (1-\beta^2)\,y^2
 \,-\, 2\alpha\beta\,xy \nonumber \\
& & \quad +\ (\alpha^2+\beta^2-1)\,(\alpha x+\beta y)
 \,-\, \quarter(\alpha^2+\beta^2-1)^2 \,=\, 0
\ea
which clearly represents a conic section. The nature of this conic
may be determined \cite{eisenhart60} by inspecting the signs of the
invariants
\be
k \,=\, (1-\alpha^2)(1-\beta^2) - \alpha^2\beta^2 \,,
\ee
which simplifies to $k=1-(\alpha^2+\beta^2)$, and
\be
D \,=\,
\left| \begin{array}{ccc}
1-\alpha^2 &
-\,\alpha\beta &
\half\alpha(\alpha^2+\beta^2-1) \\ \\
-\,\alpha\beta &
1-\beta^2 &
\half\beta(\alpha^2+\beta^2-1) \\ \\
\half\alpha(\alpha^2+\beta^2-1) &
\half\beta(\alpha^2+\beta^2-1) &
-\quarter(\alpha^2+\beta^2-1)^2
\end{array} \right| \,,
\ee
which gives the value $D=-\,\quarter[\,1-(\alpha^2+\beta^2)\,]^2
=-\,\quarter k^2$ on expansion.

When $k=0$ (i.e., the point ${\bf p}$ lies {\it on\/} the circle
$C$), equation (\ref{ellipse}) becomes $(\beta x-\alpha y)^2=0$,
and the bisector degenerates into a straight line --- the normal
to $C$ at ${\bf p}$ --- counted twice. Otherwise, the bisector is
a non--degenerate conic: an ellipse or (one branch of a)
hyperbola according to
whether $k>0$ or $k<0$ (i.e., whether ${\bf p}$ lies {\it inside\/}
or {\it outside\/} $C$). Some examples are illustrated in Figure 1.
} \QED
\end{exmpl}

\subsection{The point/curve distance function}

In characterizing the parabola as the bisector of a point
${\bf p}$ and a straight line $L$, the meaning of the ``distance''
of any point from $L$ is clear: it is simply the length of the
{\it unique\/} perpendicular from the point in question to the
straight line $L$. In substituting a smooth parametric curve $C$
in place of $L$, we need to generalize this notion of distance
(see \cite{kelly79}):

\begin{dfn}
The distance of a point ${\bf p}$ from a regular parametric curve
${\bf r}(u)$ $=\{x(u),y(u)\}$ defined on the parameter interval
$I$ is given by
\be \label{distance}
\dist({\bf p},{\bf r}(u)) \,=\,
\inf_{u \,\in\, I} \, |\,{\bf p}-{\bf r}(u)\,| \,,
\ee
i.e., it is the greatest lower bound, for all $u \in I$, on the distance
measured between the fixed point ${\bf p}$ and each point ${\bf r}(u)$
along the curve.
\end{dfn}

If ${\bf r}(u)$ is a polynomial curve, of course, the bound
(\ref{distance}) is always attained at a {\it finite\/} parameter
value $u$ regardless of whether $I$ has finite or infinite extent.
When ${\bf r}(u)$ is a rational curve and $I$ is not finite,
however, it is possible that (\ref{distance}) may be attained in
the limit $|u|\to\infty$ if the degree of $W(u)$ is not less than
the greater of the degrees of $X(u)$ and $Y(u)$. 
For example, consider the point ${\bf p} = (-2,0)$ and the circle
${\bf r}(u) = 
(\frac{1-u^{2}}{1+u^{2}},\frac{2u}{1+u^{2}})$, $u \in (-\infty,\infty)$,
which is the unit circle centered at the origin with 
${\bf r}(\infty) = (-1,0)$.
Note that as $|u|
\to\infty$ the rational curve (\ref{ratcurve}) converges to an
affine point $(x_\infty,y_\infty)$, where $|x_\infty|=|a_n/c_n|$
and $|y_\infty| =|b_n/c_n|$, if and only if ${\rm deg}(W)\ge\max
({\rm deg}(X),{\rm deg}(Y))$; otherwise it has a point at infinity
at infinite values of $u$. In the former case it is always possible
to re--parameterize (\ref{ratcurve}) by a bilinear transformation
of the parameter so as to make $(x_\infty,y_\infty)$ correspond to
a {\it finite\/} parameter value.

\begin{propn} \label{polydist}
For the point ${\bf p}=(\alpha,\beta)$ and the polynomial curve
${\bf r}(u)$ given by $(\ref{polycurve})$, let $\{u_1,\ldots,u_N\}$
be the set of distinct odd--multiplicity roots of the polynomial
\be \label{Pperp}
P_\perp(u) \,=\,
[\,\alpha-X(u)\,]\,X'(u) \,+\, [\,\beta-Y(u)\,]\,Y'(u)
\ee
of degree $2n-1$ on the interior of the interval $I$, augmented by
the finite end points, if any, of $I$. Then the distance function
$(\ref{distance})$ may be expressed as
\be \label{distance2}
\dist({\bf p},{\bf r}(u)) \,=\,
\min_{k \,\in\, \{1,\ldots,N\}} \, |\,{\bf p}-{\bf r}(u_k)\,| \,.
\ee
\end{propn}

\prf On differentiating the expression
\be \label{distsq}
|\,{\bf p}-{\bf r}(u)\,|^2 \,=\,
[\,\alpha-X(u)\,]^2 \,+\, [\,\beta-Y(u)\,]^2 \,,
\ee
we see that the distance $|\,{\bf p}-{\bf r}(u)\,|$ will attain
a ``stationary'' value whenever $[\,\alpha-X(u)\,]\,X'(u)\,+\,
[\,\beta-Y(u)\,]\,Y'(u)=0$, i.e., at the roots of the polynomial
$P_\perp(u)$. (Note that, by virtue of the constraint (\ref{regpoly}),
this equation will never be satisfied in the degenerate case $X'(u)=
Y'(u)=0$.) Only those roots of $P_\perp(u)$ that are of {\it odd\/}
multiplicity identify local extrema of $|\,{\bf p}-{\bf r}(u)\,|$,
however. To evaluate (\ref{distance}) we must compare the values of
$|\,{\bf p}-{\bf r}(u)\,|$ at each odd root of $P_\perp(u)$ on the
parameter interval $I$ and at its end points if they are finite
(since $|\,{\bf p}-{\bf r}(u)\,|\to\infty$ for any polynomial curve
as $|u|\to\infty$). Then $\dist({\bf p},{\bf r}(u))$ is given by
the smallest of these values. \QED

A result analogous to Proposition \ref{polydist} holds for regular
rational curves, provided we replace the odd roots of the polynomial
(\ref{Pperp}) by those of
\ba \label{Rperp}
P_\perp(u)
&=& [\,\alpha W(u)-X(u)\,]\,[\,W(u)X'(u)-W'(u)X(u)\,] \nonumber \\
&+& [\,\beta  W(u)-Y(u)\,]\,[\,W(u)Y'(u)-W'(u)Y(u)\,]
\ea
satisfying $W(u)\not=0$ on the interval $I$. (These roots never
correspond to the degenerate case $W(u)X'(u)-W'(u)X(u)=W(u)Y'(u)-
W'(u)Y(u)=0$ with $W(u)\not=0$ when the constraint (\ref{regrat})
is imposed.)

Thus, in computing $\dist({\bf p},{\bf r}(u))$ for a rational curve,
we compare the values of the distance $|\,{\bf p}-{\bf r}(u)\,|$
at each odd root of (\ref{Rperp}) and at finite
end points of the parameter interval $I$ satisfying $W(u)\not=0$
and/or at infinite end points in the case that ${\rm deg}(W)\ge
\max({\rm deg}(X),{\rm deg}(Y))$.

\begin{rmk}
{\rm
Note that equations (\ref{Pperp}) and (\ref{Rperp}) have an
obvious geometric interpretation: in each case, the roots of the
polynomial $P_\perp(u)$ identify points of the curve where lines
drawn from ${\bf p}$ meet ${\bf r}(u)$ orthogonally. The distance
(\ref{distance}) is then simply the smallest of the lengths of
these perpendiculars (and the chords drawn from ${\bf p}$ to
the affine end points of ${\bf r}(u)$, if any). Insisting that
${\bf r}(u)$ have a regular parameterization guarantees that
$P_\perp(u)$ will not vanish in degenerate cases where $x'(u)=
y'(u)=0$ --- which do not, in general, identify perpendiculars
to ${\bf r}(u)$ from ${\bf p}$.
}
\end{rmk}

The preceding characterizations of the distance function for
polynomial and rational curves extends to arbitrary analytic
curves. In general, we write
\be \label{distance3}
\dist({\bf p},{\bf r}(u)) \,=\,
\min_{k \,\in\, \{1,\ldots,N\}} \, |\,{\bf p}-{\bf r}(u_k)\,| \,,
\ee
where $u_1,\ldots,u_N$ identify all the points on the analytic
curve ${\bf r}(u)$ where a line drawn from ${\bf p}$ meets the
curve orthogonally (and the curve does not cross its tangent line),
as well as the affine end points of ${\bf r}(u)$ (if any). In the
case of an arbitrary analytic curve, of course, the determination
of these parameter values will generally be more difficult than
isolating and approximating the odd roots of the polynomials
(\ref{Pperp}) and (\ref{Rperp}) in the case of polynomial
and rational curves.

\begin{exmpl}
For an algebraic curve ${\bf f}(x,y) = 0$,
\be 
\dist({\bf p},{\bf f}(x,y)) \,=\,
\min_{k \,\in\, \{1,\ldots,N\}} \, |\,{\bf p}-{\bf f}(x_k,y_k)\,| \,,
\ee
where $Q_1 = (x_1,y_1),\ldots,Q_N = (x_N,y_N)$ identify all of the roots
$Q = (x,y)$ on the algebraic curve $f(x,y)$ of
\be 
[\,\alpha-x\,]\,f_y(Q) \,-\, [\,\beta-y\,]\,f_x(Q) = 0
\ee
where $f_x$ and $f_y$ are the derivatives of $f$ with respect to $x$ and $y$.
These are the points where the curve is either singular (in the sense
of an algebraic curve) or the line drawn from $p$ meets the curve orthogonally
(since the tangent at a point $Q$ is parallel to the vector $(f_y(Q),-f_x(Q))$
\cite[p. 55]{W50}).
\end{exmpl}

We now note some important properties of the distance function:

\begin{propn}
The function $\dist({\bf p},{\bf r}(u))$ varies continuously with
the location of the point ${\bf p}$, but is not always differentiable
with respect to ${\bf p}$, when ${\bf r}(u)$ is a regular polynomial
or rational curve.
\end{propn}

\prf The continuity of $\dist({\bf p},{\bf r}(u))$ follows immediately
from a more general result concerning the distance between a point
${\bf p}$ and a non--empty set ${\cal S}$ in a metric space (see \cite
{kelly79}, Theorem 3, p.~53). However, it is instructive to examine
this property in greater detail within the present context. For the
sake of brevity we discuss only the case of a polynomial curve
${\bf r}(u)$ below; the extension to a rational curve is relatively
straightforward.

Consider expression (\ref{Pperp}) as a polynomial in {\it three\/}
variables, namely, the parameter value $u$ and the coordinates
$(\alpha,\beta)$ of
the point ${\bf p}$:
\be \label{Pperp2}
P_\perp(u,\alpha,\beta) \,=\,
[\,\alpha-X(u)\,]\,X'(u) \,+\, [\,\beta-Y(u)\,]\,Y'(u) \,.
\ee
At the reference point $(\alpha_0,\beta_0)$, let $u_{k,0} \in I$ be a
simple root of (\ref{Pperp2}), so that $\partial P_\perp/\partial u
\not=0$ when $u=u_{k,0}$. Then by the {\it implicit function theorem\/}
\cite{buck78}, we deduce the existence of a function $\phi_k(\alpha,
\beta)$, analytic in some two--dimensional neighborhood ${\cal N}_k$
of $(\alpha_0,\beta_0)$, such that $\phi_k(\alpha_0,\beta_0)=u_{k,0}$
and
\be
P_\perp(\phi_k(\alpha,\beta),\alpha,\beta) \equiv 0
\quad {\rm for\ all\ } (\alpha,\beta) \in {\cal N}_k \,.
\ee
Intuitively, the function $\phi_k(\alpha,\beta)$ describes how the
root $u_k$ of $P_\perp(u)$ moves in the vicinity of its nominal
value $u_{k,0}$ as the point ${\bf p}=(\alpha,\beta)$ executes any
path within the neighborhood ${\cal N}_k$ of its nominal location
${\bf p}_0=(\alpha_0,\beta_0)$.

If $u_k$ represents a finite end point of the parameter interval
$I$ on which ${\bf r}(u)$ is defined, rather than a root of (\ref
{Pperp2}), it can be incorporated into the above framework by
simply taking $\phi_k(\alpha,\beta) \equiv u_k$.

Thus, about any nominal location ${\bf p}_0=(\alpha_0,\beta_0)$, we
may invoke (\ref{distance2}) to formulate the distance function in
a neighborhood of that location as
\be \label{distance4}
\dist({\bf p},{\bf r}(u)) \,=\,
\min_{k \,\in\, \{1,\ldots,N\}} \,
|\,{\bf p}-{\bf r}(\phi_k({\bf p}))\,|
\quad {\rm for\ all\ } {\bf p} \in {\cal N} \,,
\ee
where ${\cal N}=\bigcap\,{\cal N}_k$ represents the area common
to each of the neighborhoods of ${\bf p}_0=(\alpha_0,\beta_0)$ in
which the root functions $\phi_k({\bf p})=\phi_k(\alpha,\beta)$ are
analytic.

In the formulation (\ref{distance4}), the continuity of $\dist
({\bf p},{\bf r}(u))$ with respect to ${\bf p}=(\alpha,\beta)$ at
the (arbitrary) reference point $(\alpha_0,\beta_0)$ is now apparent:
each of the terms
\be \label{distancek}
|\,{\bf p}-{\bf r}(\phi_k({\bf p}))\,| \,=\,
\sqrt{ \, [\,\alpha-X(\phi_k(\alpha,\beta))\,]^2
         + [\,\beta-Y(\phi_k(\alpha,\beta))\,]^2 }
\ee
is continuous with respect to ${\bf p}$ at $(\alpha_0,\beta_0)$, since
the functions $\phi_k(\alpha,\beta)$ are analytic there and the curve
${\bf r}(u)=\{X(u),Y(u)\}$ is continuous everywhere, and although the
index $k$ that achieves the minimum in (\ref{distance4}) may suddenly
jump --- from $i$ to $j$, say --- as we move through $(\alpha_0,\beta_0)$,
we nevertheless have $|\,{\bf p}-{\bf r}(\phi_i({\bf p}))\,|=|\,{\bf p}
-{\bf r}(\phi_j({\bf p}))\,|$ at any such jump.

If such a jump occurs in traversing $(\alpha_0,\beta_0)$, however,
$\dist({\bf p},{\bf r}(u))$ will not, in general, be differentiable
with respect to ${\bf p}$ there. To see why, we consider the {\it
directional derivative}
\be \label{vnabla}
\nabla_{\bf v} \, \dist({\bf p},{\bf r}(u))
\,=\, {1 \over |{\bf v}|} \left[
v_x {\partial \over \partial\alpha} +
v_y {\partial \over \partial\beta} \, \right]
\dist({\bf p},{\bf r}(u)) \,,
\ee
which measures the rate of change of the distance function in the
direction of the vector ${\bf v}=(v_x,v_y)$ at the point $(\alpha_0,
\beta_0)$ at which the partial derivatives in (\ref{vnabla}) are
evaluated. Now by formal differentiation using the chain rule, and
noting that $P_\perp(\phi_k(\alpha,\beta),\alpha,\beta)=0$, the
partial derivatives of the functions $\Delta_k(\alpha,\beta)=|\,
{\bf p}-{\bf r}(\phi_k({\bf p}))\,|$ given by (\ref{distancek})
may be expressed as
\be \label{pderivs}
{\partial\Delta_k \over \partial\alpha}
= {\alpha-X(\phi_k(\alpha,\beta)) \over \Delta_k(\alpha,\beta)}
\quad {\rm and} \quad
{\partial\Delta_k \over \partial\beta}
= {\beta-Y(\phi_k(\alpha,\beta)) \over \Delta_k(\alpha,\beta)} \,.
\ee
In (\ref{pderivs}) it is understood that $k$ represents the index
minimizing $\Delta_k(\alpha,\beta)$, and if $k$ jumps from $i$ to $j$
on passing through $(\alpha_0,\beta_0)$ in the direction ${\bf v}$, it
is in general true that
\be
X(\phi_i(\alpha_0,\beta_0)) \not= X(\phi_j(\alpha_0,\beta_0))
\quad {\rm and} \quad
Y(\phi_i(\alpha_0,\beta_0)) \not= Y(\phi_j(\alpha_0,\beta_0)) \,,
\ee
although $\Delta_i(\alpha_0,\beta_0)=\Delta_j(\alpha_0,\beta_0)$.
Therefore, the magnitude of the derivative (\ref{vnabla}) jumps
for any direction ${\bf v}$ in which we traverse a point $(\alpha_0,
\beta_0)$ with which we associate a jump in the index $k$ that realizes
the mimimum value on the right--hand side of (\ref{distance2}). \QED

\section{Offset curves and bisectors}
\label{offsets}

In formulating a tractable representation for the bisector of a
point ${\bf p}$ and a regular parametric curve ${\bf r}(u)$, it will
be useful to recall the definition and some basic properties of the
{\it offset curves\/} to ${\bf r}(u)$ (see \cite{farouki90a} and
\cite{farouki90b} for a thorough discussion).

\begin{dfn}
The bisector ${\bf B}({\bf p},{\bf C})$ of a point ${\bf p}$ and a curve 
${\bf C}$ is the locus
traced by a point that remains equidistant from ${\bf p}$ and ${\bf C}$.
\end{dfn}

\subsection{Fixed--distance offsets}

We begin by noting that if the curve ${\bf r}(u)$ is regular on the
interval $u \in I$, its unit normal vector
\be \label{normal}
{\bf n}(u) \,=\, {(y'(u),-x'(u)) \over \sqrt{x'^2(u)+y'^2(u)}}
\ee
is defined and continuous for all $u \in I$.

\begin{dfn}
The untrimmed offset at (signed) distance $d$ to a regular parametric
curve ${\bf r}(u)$ is the locus defined by
\be \label{offset}
{\bf r}_o(u) \,=\, {\bf r}(u) + d\,{\bf n} (u) \,.
\ee
\end{dfn}

Note that when ${\bf r}(u)$ is a polynomial or rational curve, the
offset ${\bf r}_o(u)$ is not, in general, a polynomial or rational
curve, because of the radical expression in the denominator of (\ref
{normal}). Consequently, the offset curve is often approximated by
piecewise--polynomial forms \cite{hoschek88,klass83,pham88,tiller84}
in practical computer--aided design (CAD) applications, to render it
compatible with their representational and algorithmic infrastructure.
(The ``interior'' and ``exterior'' offsets, at distances $-d$ and
$+d$, together form an {\it algebraic curve\/} with an implicit
polynomial equation $f_o(x,y)=0$ \cite{farouki90b}. See also \cite
{farouki90c,farouki91a} for discussion of a special class of
polynomial curves whose offsets are rational.)

We call the locus (\ref{offset}) the ``untrimmed'' offset for the
following reason: {\it Corresponding points\/} ${\bf r}(u)$ and
${\bf r}_o(u)$ on the given curve and its untrimmed offset are
evidently distance $d$ apart, measured along their mutual normal
direction. However, the point ${\bf r}_o(u)$ of the untrimmed offset
is not necessarily distance $d$, in the sense of the distance function
(\ref{distance}), from the {\it entire curve\/} ${\bf r}(u)$. We call
the locus having this latter property the ``trimmed'' offset to
${\bf r}(u)$, since it is obtained by deleting certain continuous
segments of (\ref{offset}).

The trimming procedure may be characterized by the following
property of the untrimmed offset curve (\ref{offset}):

\begin{propn} \label{offtrim}
For a regular polynomial or rational curve ${\bf r}(u)$ defined on
the interval $u \in I$, let $\{i_1,\ldots,i_M\}$ be the ordered set
of parameter values on $I$ that correspond to self--intersections
of its untrimmed offset ${\bf r}_o(u)$ at distance $d$, i.e.,
${\bf r}_o(i_j)={\bf r}_o(i_k)$ for some $1 \le j\not=k \le N$.
Then, denoting the end points of $I$ by $i_0$ and $i_{M+1}$, we
have either
\be
\dist({\bf r}_o(t),{\bf r}(u)) \,\equiv\, d \quad {\rm for\ all\ }
t \in (i_k,i_{k+1})
\ee
or
\be
\dist({\bf r}_o(t),{\bf r}(u)) \,<\, d \quad {\rm for\ all\ }
t \in (i_k,i_{k+1})
\ee
on each span $(i_k,i_{k+1})$ for $k=0,\ldots,M$ between successive
self--intersections of the untrimmed offset.
\end{propn}

\prf See Theorem 4.4 in \cite{farouki90a}. \QED

Proposition \ref{offtrim} indicates that if we dissect the
untrimmed offset ${\bf r}_o(u)$ into the subsegments delineated by
its self--intersections, then each subsegment should be retained
or discarded in its entirety in forming the trimmed offset. It is
sufficient to test the distance of a single point interior to each
span $(i_k,i_{k+1})$ of ${\bf r}_o(u)$ from the given curve ${\bf r}
(u)$ (the mid point $\half(i_k+i_{k+1})$, say) to determine whether
or not that span should be eliminated.

PICTURE OF UNTRIMMED VS. TRIMMED OFFSET OF, SAY, A PARABOLA

Note that trimming an offset curve is a problem in the {\it global
topology\/} of the locus defined by (\ref{offset}); we know of no
simpler algorithm for the trimming process than the methodical
dissect--and--test procedure described above.

The fact that the untrimmed offset (\ref{offset}) is {\it not\/} a
rational curve complicates somewhat the problem of determining the
parameter values ${i_1,\ldots,i_M}$ of its self--intersections; see
\cite{farouki90b}. We shall encounter a similar ``trimming'' problem
in computing point/curve bisectors which, surprisingly, proves to be
much simpler because the untrimmed curve happens to be rational (see
below).

\begin{rmk}
{\rm
The trimmed offsets at distance $\pm d$ to a given curve ${\bf r}(u)$
are the ``level curves'' for the point/curve distance function $(\ref
{distance})$, i.e., they are the loci of points ${\bf p}$ that satisfy
$\dist({\bf p},{\bf r}(u))=|d|$.
}
\end{rmk}

\subsection{The untrimmed point/curve bisector}
\label{sec:untrim}

We can generalize the notion of an (untrimmed) offset curve at fixed
distance $d$ to a given regular curve ${\bf r}(u)$ by substituting
any continuous function $d(u)$ of the parameter $u$ in place of the
constant $d$. The differentiability of the {\it variable--distance
offset curve}
\be \label{varoffset}
{\bf r}_o(u) \,=\, {\bf r}(u) + d(u) {\bf n}(u)
\ee
is then constrained by that of the ``displacement function'' $d(u)$.
We shall find the form (\ref{varoffset}) to be valuable in analyzing
point/curve bisectors.

Consider the {\it family of normal lines\/} to a given regular curve
${\bf r}(u)$. These lines may be parameterized in the form
\be \label{nline}
{\bf r}(u) + \lambda\,{\bf n}(u) \,,
\ee
where $u$ selects a point on the curve, and $\lambda$ measures the
signed distance along the normal line from that point.

Given any point ${\bf p}$ not on ${\bf r}(u)$, the location on the
normal line (\ref{nline}) that is equidistant from ${\bf p}$ and the
curve point ${\bf r}(u)$ is uniquely identified by the condition
\be
\lambda \,=\, |\,{\bf r}(u)+\lambda\,{\bf n}(u)-{\bf p}\,| \,.
\ee
Now for each $u$, let $d(u)$ denote the unique value $\lambda$
satisfying this condition. 
% FIGURE: \figg{fig:du}{}{.5in}
Referring to Figure~\ref{fig:du},
by the law of cosines,
\be
	d(u)^{2} = d(u)^{2} + |{\bf p} - {\bf r}(u)|^{2} - 
		   2d(u) \ |{\bf p} - {\bf r}(u)| \ \cos \theta
\ee
	% a^{2}  = b^{2} + c^{2} - 2bc cos A, [A-18]{TF81}
or 
\be
	d(u) = \frac{|{\bf p} - {\bf r}(u)|^{2}}
		    {2|{\bf p} - {\bf r}(u)|\cos \theta}.
\ee
Since $\cos \theta$ is the dot product of its two defining unit vectors,
\be
\label{eq:cos}
	\cos \theta = \frac{({\bf p}-{\bf r}(u)) \cdot {\bf n}(u)}
			   {|{\bf p} - {\bf r}(u)|}.
\ee
	% \cos \theta = (A \cdot B)/(||A|| ||B||)  [20]{LA71}
and
\be \label{du}
d(u) \,=\, {|\,{\bf p}-{\bf r}(u)\,|^2 \over
2\,({\bf p}-{\bf r}(u))\dotpr{\bf n}(u)} \,,
\ee
(In the figure, we are assuming that $d(u)$ is positive, {\em i.e.}, 
${\bf n}(u)$ points towards
${\bf p}$'s halfplane.
(\ref{du}) still holds if $d(u)$ is negative,
because the sign change of $d(u)$ is balanced by the sign
change of ${\bf n}(u)$ in (\ref{eq:cos}).)
Note that (\ref{du}) is evidently 
{\it not\/} (in general) a rational function of
$u$, because of the radical incurred in computing the unit normal
vector ${\bf n}(u)$.

\begin{dfn}
The {\it untrimmed bisector\/} of a point ${\bf p}$ and a regular
curve ${\bf r}(u)$ is the variable--distance offset $(\ref{varoffset})$
to ${\bf r}(u)$ defined by the function $(\ref{du})$.
\end{dfn}

The curve defined by (\ref{varoffset}) and (\ref{du}) is simply
the locus of points on the normal lines (\ref{nline}) which are
equidistant from each curve point ${\bf r}(u)$ and the given point
${\bf p}$ (Figure~\ref{fig:du}).
We will show below that it is appropriately named, {\em i.e.}, it
is a superset of the bisector ${\bf B}({\bf p},{\bf r}(u))$ 
(Proposition~\ref{p:superset}).

\begin{rmk}
{\rm
When ${\bf r}(u)$ is a polynomial or rational curve, the untrimmed
bisector defined by $(\ref{varoffset})$ and $(\ref{du})$ has a
{\it rational\/} parameterization, since the radicals in $d(u)$
and ${\bf n}(u)$ cancel precisely.
}
\end{rmk}

Let $\psi(u)$ denote the angle between the vector from ${\bf r}(u)$
to ${\bf p}$ and the curve normal ${\bf n}(u)$, measured in the
right--handed sense defined by a unit vector ${\bf z}$ orthogonal
to the plane of the curve. Then the function $d(u)$ may also be
written as
\be
d(u) \,=\, \half\,|\,{\bf p}-{\bf r}(u)\,|\sec\psi(u) \,,
\ee
where we take $-\pi/2<\psi(u)\le\pi/2$ (Figure~\ref{fig:sec}).

% FIGURE: \figg{fig:sec}{}{.5in}

Note that the displacement function satisfies $d(u)\not=0$ for
all $u$ if the given point ${\bf p}$ does not lie on the curve
${\bf r}(u)$. However, at each parameter value $\tau$ such that
$({\bf p}-{\bf r}(\tau))\dotpr{\bf n}(\tau)=0$ ({\em i.e.}, the curve
normal at ${\bf r}(\tau)$ is orthogonal to the vector from
${\bf r}(\tau)$ to ${\bf p}$ or, equivalently, 
the tangent at ${\bf r}(\tau)$ intersects 
${\bf p}$) the untrimmed bisector exhibits a
``point at infinity.'' For the polynomial curve (\ref{polycurve}),
the parameter values corresponding to these points at infinity
are the roots of the polynomial
\be \label{Pinf}
P_\infty(u) \,=\,
[\,\alpha-X(u)\,]\,Y'(u) \,-\, [\,\beta-Y(u)\,]\,X'(u) \,,
\ee
which is of degree $2n-1$ (at most) when ${\bf r}(u)$ is of
degree $n$. Similarly, for the rational curve (\ref{ratcurve}),
the polynomial whose roots identify points at infinity on the
untrimmed bisector is
\ba \label{Rinf}
P_\infty(u)
&=& [\,\alpha W(u)-X(u)\,]\,[\,W(u)Y'(u)-W'(u)Y(u)\,] \nonumber \\
&-& [\,\beta  W(u)-Y(u)\,]\,[\,W(u)X'(u)-W'(u)X(u)\,] \,.
\ea

We will denote the untrimmed bisector defined by (\ref{varoffset})
and (\ref{du}) by ${\bf b}(u)$, with homogeneous coordinates given
by the polynomials $X_b(u)$, $Y_b(u)$, $W_b(u)$. For the polynomial
curve (\ref{polycurve}), it may be verified that
\ba \label{pbsctr}
X_b &=& [\,\alpha^2-X^2+(\beta-Y)^2\,]\,Y'
 \,-\, 2(\beta-Y)XX' \,, \nonumber \\
Y_b &=& 2(\alpha-X)YY'
 \,-\, [\,(\alpha-X)^2+\beta^2-Y^2\,]\,X' \,, \nonumber \\
W_b &=& 2\,[\,(\alpha-X)Y'-(\beta-Y)X'\,] \,,
\ea
while in the case of the rational curve (\ref{ratcurve}) we have
\ba \label{rbsctr}
X_b &=& [\,\alpha^2W^2-X^2+(\beta W-Y)^2\,]\,V
 \,-\, 2(\beta W-Y)XU \,, \nonumber \\
Y_b &=& 2(\alpha W-X)YV
 \,-\, [\,(\alpha W-X)^2+\beta^2W^2-Y^2\,]\,U \,, \nonumber \\
W_b &=& 2W\,[\,(\alpha W-X)V-(\beta W-Y)U\,] \,,
\ea
where $U=WX'-W'X$ and $V=WY'-W'Y$.

\begin{rmk}
{\rm
It may be verified from (\ref{pbsctr}) and (\ref{rbsctr}) that when
${\bf r}(u)$ is a {\it polynomial\/} curve of degree $n$, the untrimmed
bisector ${\bf b}(u)$ is a rational curve of degree $3n-1$ at most,
whereas if ${\bf r}(u)$ is a {\it rational\/} curve of degree $n$, the
untrimmed bisector is of degree $4n-1$ at most.
}
\end{rmk}

We now show that the untrimmed bisector is a superset of the bisector.

\begin{dfn}
Let $C_{q}$ be the circle with center $q$ and radius $||{\bf p}-q||$.
\end{dfn}

\begin{rmk}
\label{rmk:bis}
$q$ lies on the bisector of ${\bf p}$ and the regular curve 
${\bf r}(u)$ if and only if 
\begin{itemize}
\item
$C_q$ does not contain any 
points of ${\bf r}(u)$ in its interior ($C_q$ is ``empty''), and 
\item
$C_q$ is tangent to ${\bf r}(u)$ in at least one 
point.
\end{itemize}
(Figure~\ref{fig:bis}.)
% 	If ${\bf r}(u)$ is not regular, 
% 	then the second condition should instead be
%  	that the boundary of the circle ${\bf C}_q$ 
%	contains at least one point of ${\bf r}(u)$.
\end{rmk}
\prf
$q$ lies on the bisector if and only if the closest point of ${\bf r}(u)$
to $q$ is at distance $||{\bf p}-q||$.
\QED

% FIGURE: \figg{fig:bis}{}{.5in}

Note that when we are computing the bisector for a curve segment,
the circle $C_q$ may contain points of the curve outside of the segment.

\begin{propn}
\label{p:superset}
The untrimmed bisector of ${\bf p}$ and ${\bf r}(u)$
is a superset of the bisector of ${\bf p}$ and ${\bf r}(u)$.
\end{propn}
\prf
Let $q$ be a point of the bisector of ${\bf p}$ and ${\bf r}(u)$.
By Remark~\ref{rmk:bis}, there exists a point ${\bf r}(u_{0})$ of the curve 
that lies on the circle ${\bf C}_q$,
such that the curve is tangent
to the circle at ${\bf r}(u_{0})$ or, equivalently, 
such that the normal at ${\bf r}(u_{0})$ 
intersects the center $q$ of the circle ${\bf C}_q$.
Thus, ${\bf r}(u_{0}) + d(u_{0}) {\bf n}(u_{0}) = q$.
\QED

Since the second condition of Remark~\ref{rmk:bis}
is satisfied for all points $q$ of the untrimmed bisector (by definition),
a point $q$ of the untrimmed bisector
is a point of the bisector if and only if the interior of ${\bf C}_q$ is empty.

\begin{exmpl}
{\rm
The simplest polynomial curve, other than a straight line, is the
parabola. Consider the case ${\bf p}=(\alpha,\beta)$ and ${\bf r}(u)=
(u,u^2)$. From equations (\ref{pbsctr}), we have the representation
\ba \label{Bprbla}
X_b(u) &=& 2u\,[\,u^4-2\beta u^2+\alpha^2+\beta^2-\beta\,] \,,
\nonumber \\
Y_b(u) &=& -\ 3u^4+4\alpha u^3-u^2+2\alpha u-\alpha^2-\beta^2 \,,
\nonumber \\
W_b(u) &=& -\ 2u^2+4\alpha u-2\beta \,,
\ea
for the untrimmed bisector, which is evidently a rational curve of
degree {\it five}. Figure 2 illustrates representative examples of
the curves defined by (\ref{Bprbla}).
} \QED
\end{exmpl}

\begin{exmpl}
{\rm
As a simple example of the untrimmed bisector of a point and a rational curve,
we consider the case where $C$ is an ellipse centered on the origin,
with semi--axes $a$ and $b$. Then $C$ has the rational parameterization
\be
X(u) \,=\, a(1-u^2) \,, \quad
Y(u) \,=\, 2bu \,, \quad
W(u) \,=\, 1+u^2 \,.
\ee
Substituting the above into (\ref{rbsctr}), we find that the untrimmed
bisector is a rational curve of degree {\it six}, defined by
\ba \label{Bellps}
X_b(u)
&=& (1-u^2)\,
[\,(\alpha^2+\beta^2-a^2)bu^4 \,+\,
4\beta(a^2-b^2)u^3 \nonumber \\
&+& \!\! 2(\alpha^2+\beta^2-3a^2+2b^2)bu^2
\,+\, 4\beta(a^2-b^2)u
\,+\, (\alpha^2+\beta^2-a^2)b\,] \,, \nonumber \\
Y_b(u)
&=& 2\,u\,
[\,((\alpha^2+\beta^2)a+2\alpha(a^2-b^2)+(a^2-2b^2)a)u^4 \nonumber \\
&+& \!\! 2(\alpha^2+\beta^2-a^2)au^2
\,+\, (\alpha^2+\beta^2)a-2\alpha(a^2-b^2)+(a^2-2b^2)a\,] \,, \nonumber \\
W_b(u)
&=& 2(1+u^2)^2\,
[-\,(\alpha+a)bu^2
\,+\, 2\beta au
\,+\,(\alpha-a)b\,] \,.
\ea
Some examples are illustrated in Figure 3.
} \QED
\end{exmpl}

\subsection{Irregular points of the untrimmed bisector}

It is evident from Figures 2 and 3 that in general the untrimmed
bisector of a point ${\bf p}$ and a regular curve ${\bf r}(u)$ is
{\it not\/} a smooth locus, even though ${\bf r}(u)$ is necessarily
smooth if it has a regular parameterization.

Recall \cite{kreyszig59} that for any regular parametric curve
${\bf r}(u)$, the elementary differential characteristics at each
point may be expressed in terms of the parametric derivatives
${\bf r}'(u),{\bf r}''(u),\ldots$ there as
\be \label{diffchar}
{\bf t} \,=\, {{\bf r}' \over |{\bf r}'|} \,, \quad
{\bf n} \,=\, {\bf t} \cross {\bf z} \,, \quad
\kappa \,=\, {({\bf r}' \cross {\bf r}'') \dotpr {\bf z}
  \over |{\bf r}'|^3} \,,
\ee
${\bf z}$ being a unit vector orthogonal to the plane of the curve.
The {\it normal\/} ${\bf n}(u)$ and {\it tangent\/} ${\bf t}(u)$ form
an orthonormal basis $({\bf n},{\bf t},{\bf z})$ with ${\bf z}$ at
each point $u$, while $\kappa(u)$ is the (signed) {\it curvature}.
The variation of the tangent and normal along the curve is described
by the {\it Frenet equations} \cite{kreyszig59},
\be \label{frenet}
{\bf t}' \,=\, -\,\sigma\kappa\,{\bf n}
\quad {\rm and} \quad
{\bf n}' \,=\, \sigma\kappa\,{\bf t} \,.
\ee
Higher-order derivatives of ${\bf t}(u)$ and ${\bf n}(u)$ are readily
expressed in terms of the vectors ${\bf t}(u)$, ${\bf n}(u)$ and the
scalar functions $\sigma(u)$, $\kappa(u)$ and their derivatives; for
example:
\ba \label{frenet2}
{\bf t}'' &=& -\,\sigma^2\kappa^2\,{\bf t} \,-\,
(\sigma'\kappa+\sigma\kappa')\,{\bf n} \,, \nonumber \\
{\bf n}'' &=& (\sigma'\kappa+\sigma\kappa')\,{\bf t}
 \,-\, \sigma^2\kappa^2\,{\bf n} \,.
\ea

If we denote by ${\bf b}(u)$ the parametric representation of the
untrimmed bisector obtained by substituting from (\ref{du}) into
(\ref{varoffset}), then the parametric derivatives of ${\bf b}(u)$
may be written as
\ba \label{bderivs}
{\bf b}' &=& {\bf r}' \,+\,
  d'\,{\bf n} \,+\, d\,{\bf n}' \,, \nonumber \\
{\bf b}'' &=& {\bf r}'' \,+\,
  d''\,{\bf n} \,+\, 2d'\,{\bf n}' \,+\, d\,{\bf n}'' \,,
\ea
$\ldots$ etc. By substituting from (\ref{frenet}) and (\ref{frenet2}),
we can re--write (\ref{bderivs}) as
\ba \label{bderivs2}
{\bf b}' &=& \sigma(1+\kappa d\,)\,{\bf t} \,+\, d'\,{\bf n} \,,
 \nonumber \\
{\bf b}'' &=&
[\,\sigma'(1+\kappa d\,)+\sigma(\kappa'd+2\kappa d')\,]\,{\bf t}
 \nonumber \\
 & & \quad +\ [\,d''-\sigma^2\kappa(1+\kappa d\,)\,]\,{\bf n} \,,
\ea
where the derivatives $d'$ and $d''$ of the displacement function
(\ref{du}) appropriate to the untrimmed bisector are most conveniently
expressed in the form
\ba \label{dderivs}
d'  &=& -\ \sigma(1+\kappa d\,)\tan\psi \,,
\nonumber \\
d'' &=& -\ [\,\sigma'(1+\kappa d)+\sigma\kappa'd\,]\tan\psi
\nonumber \\
    & & \quad +\ \half\sigma^2(1+\kappa d\,)d^{-1}
    [\,1+2\kappa d+(1+4\kappa d)\tan^2\psi\,] \,,
\ea
$\ldots$ etc. In deriving (\ref{dderivs}), we make use of the fact
that the angle $\psi$ between the vector from ${\bf r}(u)$ to ${\bf p}$
and the curve normal ${\bf n}(u)$ changes at the rate
\be \label{psideriv}
\psi' \,=\, -\,\half\sigma(1+2\kappa d\,)d^{-1}
\ee
with respect to $u$, as may be deduced by differentiating expression
(\ref{du}).

Using the above expression for $d'$, we now see that the first
parametric derivative of the untrimmed bisector has the form:
\be \label{bprime}
{\bf b}' \,=\, \sigma(1+\kappa d\,)\,({\bf t}-{\bf n}\tan\psi) \,.
\ee
At each value of $u$ such that ${\bf b}'(u)\not={\bf 0}$, the
tangent ${\bf t}_b(u)$ to the untrimmed bisector is a unit vector
in the direction of (\ref{bprime}). Note that the magnitude of (\ref
{bprime}) is simply
\be \label{magbprime}
|{\bf b}'| \,=\, \sigma\,|1+\kappa d\,|\,|\!\sec\psi| \,.
\ee

Since the given curve ${\bf r}(u)$ is regular, its unit tangent
and normal ${\bf t}(u)$ and ${\bf n}(u)$ are defined and linearly
independent at each $u$, so that ${\bf t}(u)-{\bf n}(u)\tan\psi(u)$
is never the zero vector. Moreover, this vector varies continuously
with $u$ except at those parameter values where $\psi(u)=\pm\pi/2$,
which correspond to the roots of the polynomial (\ref{Pinf}),
i.e., the points at infinity on ${\bf b}(t)$. Therefore, at each
$u$ such that $P_\infty(u)\not=0$, the unit vector:
\be \label{evector}
{\bf e}(u) \,=\, |\!\cos\psi(u)| \,
[\,{\bf t}(u)-{\bf n}(u)\tan\psi(u)\,]
\ee
in the direction of ${\bf t}(u)-{\bf n}(u)\tan\psi(u)$ is well
defined and varies continuously with $u$. Since for a regular curve
$\sigma(u)\not=0$ for all $u$, we may deduce from (\ref{diffchar})
that the tangent to the untrimmed bisector is given in terms of
${\bf e}(u)$ by:
\be \label{btangent}
{\bf t}_b(u) \,=\,
{1+\kappa(u)d(u) \over |\,1+\kappa(u)d(u)\,|} \; {\bf e}(u) \,.
\ee

\begin{lma}
The untrimmed bisector ${\bf b}(u)$ exhibits a cusp, or sudden
tangent inversion, at those parameter values where $P_\infty(u)
\not=0$ and the curvature $\kappa(u)$ of the given curve ${\bf r}
(u)$ attains the local critical value
\be \label{kappacrit}
\kappa_c(u) \,=\, -\ {1 \over d(u)} \,=\,
-\ {2\cos\psi(u) \over |\,{\bf p}-{\bf r}(u)\,|} \,,
\ee
without being an extremum, i.e., $\kappa'(u)\not=0$.
\end{lma}

\prf Let $\tau$ be a parameter value such that $P_\infty(\tau)
\not=0$ (i.e., ${\bf b}(\tau)$ is an affine point of the untrimmed
bisector), and the curvature of the given curve ${\bf r}(u)$
satisfies both $\kappa(\tau)=-1/d(\tau)$ and $\kappa'(\tau)\not=0$.
Then $\tan\psi(\tau)$ is finite, and the unit vector ${\bf e}(\tau)$
given by (\ref{evector}) is defined and continuous at $u=\tau$.
On the other hand, the scalar factor multiplying ${\bf e}(u)$ in
(\ref{btangent}) is a ``step function,'' which changes abruptly
from $-1$ to $+1$, or vice--versa, at $u=\tau$ whenever $d/du(1+
\kappa(u)d(u))\not=0$ at $u=\tau$, i.e., $\kappa'(\tau)d(\tau)+
\kappa(\tau)d'(\tau)\not=0$. But from (\ref{dderivs}) we observe
that $d'(\tau)=0$ whenever $\kappa(\tau)=-1/d(\tau)$, and since we
certainly have $d(\tau)\not=0$ because ${\bf p}$ does not lie on
${\bf r}(u)$, the condition $d/du(1+\kappa(u)d(u))\not=0$ at $u=
\tau$ is exactly equivalent to $\kappa'(\tau)\not=0$. \QED

\begin{rmk}
{\rm
It is interesting to note that the criteria $\kappa(u)=-1/d(u)$
and $\kappa'(u)\not=0$ identifying the cusps of the ``variable
offset'' $(\ref{varoffset})$ are identical to those for a simple
offset ($\kappa(u)=-1/d$, $\kappa'(u)\not=0$) with $d(u)={\rm constant}$
$\cite{farouki90a}$. This is not a {\it generic} feature of variable
offsets, but arises rather from the specific form $(\ref{du})$ of
$d(u)$ for the untrimmed bisector.
}
\end{rmk}

The local critical curvature (\ref{kappacrit}) is attained at those
roots of the equation
\be
P_c(u) \,=\,
|\,{\bf p}-{\bf r}(u)\,|^2\,{\bf r}'(u)\cross{\bf r}''(u) \,+\,
2\,|{\bf r}'(u)|^2\,[\,{\bf p}-{\bf r}(u)\,]\cross{\bf r}'(u)
\,=\, 0
\ee
that satisfy $\kappa'(u)\not=0$. These parameter values correspond
to cusps on the untrimmed bisector ${\bf b}(u)$. When ${\bf r}(u)$
is the polynomial curve (\ref{polycurve}), $P_c(u)$ is a polynomial
of degree $??$ in $u$. When ${\bf r}(u)$ is the rational curve
(\ref{ratcurve}), $P_c(u)$ is a rational function in $u$, whose
numerator is of degree $??$.

Consider now the behavior of the curvature $\kappa_b(u)$ along the
untrimmed bisector. By substituting from (\ref{bderivs2}) and (\ref
{dderivs}), a straightforward but laborious calculation gives
\be
({\bf b}'\cross{\bf b}'')\dotpr{\bf z}
\,=\, \half\sigma^3(1+\kappa d\,)^2 d^{-1}
\,[\,(1+4\kappa d\,)\tan^2\psi-1\,] \,,
\ee
and together with (\ref{magbprime}) the expression $\kappa_b(u)=
|{\bf b}'(u)|^{-3}[\,{\bf b}'(u)\cross{\bf b}''(u)\,]\dotpr{\bf z}$
for the curvature of the untrimmed bisector, as a function of the
parameter $u$, reduces to
\be \label{bkappa}
\kappa_b(u) \,=\, {(1+4\kappa d\,)\tan^2\psi \,-\, 1
 \over 2d\,|1+\kappa d\,|\,|\!\sec\psi|^3} \,.
\ee
It is worthwhile emphasizing the siginificance of equation (\ref
{bkappa}) in words: at any point $u$ on the untrimmed bisector, we
can express the curvature $\kappa_b(u)$ of ${\bf b}(u)$ simply in
terms of the curvature $\kappa(u)$ of the given curve ${\bf r}(u)$,
the displacement function $d(u)$ defined by (\ref{du}), and the
angle $\psi(u)$ between the vector ${\bf p}-{\bf r}(u)$ and the
curve normal ${\bf n}(u)$.

\begin{lma}
In general, the untrimmed bisector ${\bf b}(u)$ has an extraordinary
point --- i.e., a tangent--continuous point of infinite curvature
--- at those parameter values $u$ where $P_\infty(u)\not=0$ and
the curvature $\kappa(u)$ of the given curve ${\bf r}(u)$ attains
a local extremum $(\kappa'(u)=0\ but\ \kappa''(u)\not=0)$, equal
in value to the critical curvature $-\,1/d(u)$ defined by $(\ref
{kappacrit})$.
\end{lma}

\prf Let $\tau$ be such that $P_\infty(\tau)\not=0$ and the
curvature of ${\bf r}(u)$ satisfies $\kappa(\tau)=-1/d(\tau)$ with
$\kappa'(\tau)=0$ and $\kappa''(\tau)\not=0$. Then the unit vector
${\bf e}(\tau)$ given by (\ref{evector}) is continuous at $u=\tau$
and, by the same arguments as in the preceding Lemma, the scalar
factor $(1+\kappa d\,)/|1+\kappa d\,|$ multiplying it in (\ref
{btangent}) is of the {\it same\/} sign on either side of $\tau$.
Therefore, ${\bf t}_b(u)$ is continuous at $u=\tau$. However, since
$1+\kappa(\tau)d(\tau)=0$, it is evident from (\ref{bkappa}) that
the curvature $\kappa_b(u)$ of the untrimmed bisector increases
without bound as we approach $\tau$ (since the numerator of (\ref
{bkappa}) is, in general, non--zero at such a point). \QED

\section{The trimming procedure}
\label{trimming}

The untrimmed bisector is trimmed down to the bisector by deleting
a finite number of segments.
Like with the untrimmed offset, this is done by finding
a finite number of special points that identify possible
deviations of ${\bf b}(u)$ from the bisector.
There are four classes of these special points on the untrimmed bisector
(Definitions~\ref{d:trim} and \ref{d:cri}), 
and we split the trimming into two stages.
We now describe the first stage, which removes ``inactive'' segments.

Every point ${\bf r}(u_0)$ of the curve has a corresponding point 
${\bf b}(u_0)$ of its normal on the untrimmed bisector.
However, many of these points ${\bf b}(u_0)$ are clearly not on the bisector,
because ${\bf r}(u_0)$ is clearly not the closest point of the curve to 
${\bf b}(u_0)$ (Figure~\ref{fig:notclosest}).

% FIGURE: \figg{fig:notclosest}{}{.5in}

\begin{dfn}
The points ${\bf r}(u_0)$ and 
${\bf b}(u_0) = {\bf r}(u_0) + d(u_0){\bf n}(u_0)$ are called
{\bf corresponding} points.
\end{dfn}

\begin{dfn}
The point $q = {\bf b}(u_{0})$ of the untrimmed bisector
is {\bf active} if either one of the following conditions holds:
\begin{description}
\item[(1)]
	$q$ has more than one corresponding point on the curve\footnote{There
		are only a finite number of such points, and we will have
		much more to say about them below.}
\item[(2)]
	$q$ has only one corresponding point $q' = {\bf r}(u_0)$ on the curve,
	and either:
\begin{description}
\item[(a)]
	${\bf p}$ and the circle of curvature at $q'$
	lie on opposite sides of the tangent at $q'$, or
\item[(b)]
	the circle of curvature at $q'$ contains ${\bf p}$
	({\em i.e.}, ${\bf p}$ lies on or inside the circle of curvature).
\end{description}
\end{description}
(See Figure~\ref{fig:active}.)
A segment $S$ of ${\bf b}(u)$ is active if every point of $S$ is active.
\end{dfn}

% FIGURE \figg{fig:active}{}{.5in}

\begin{rmk}
\label{r:active}
We observe that an active point appears to lie on the bisector,
at least locally.
To see this, 
let $q$ be an active point of ${\bf b}(u)$ with only one corresponding
point $q'$.
If ${\bf p}$ lies inside or on the circle of curvature at $q'$,
then all of $C_q$ also lies in the circle of curvature at $q'$ 
and, in particular, there exists a neighborhood of $q'$ 
% ({\em i.e.}, the image of a neighborhood of $t'$ where $q' = {\bf r}(t')$)
that lies completely outside of $C_q$ \cite[p. 176]{H52}.
On the other hand, if ${\bf p}$ (and thus $C_q$) lies on the opposite side 
of the tangent at $q'$ from the circle of curvature at $q'$,
then again the curve in a neighborhood of $q'$ lies completely outside of
$C_q$.
Thus, the curve in some neighborhood of an active point (with one corresponding
point) lies completely outside of $C_q$.
In other words, an active point acts at least locally
like a point of the bisector (Remark~\ref{rmk:bis}).
\end{rmk}

\begin{propn}
An inactive point of the untrimmed bisector of ${\bf p}$ and ${\bf r}(u)$
does not lie on the bisector of ${\bf p}$ and ${\bf r}(u)$.
\end{propn}
\prf
Let $q$ be an inactive point of ${\bf b}(u)$ 
and let $q'$ be the point corresponding to $q$.
By definition, ${\bf p}$ and the circle of curvature at $q'$ lie
on the same side of the tangent at $q'$, but ${\bf p}$ lies outside this
circle (Figure~\ref{fig:active}(ii)).
$C_q$ and the circle of curvature at $q'$ are both circles that are
tangent to $q'$ (or equivalently, circles with a center on the normal at $q'$)
and they both lie on the same side of this tangent.
Moreover, $C_q$ must be strictly larger than (and strictly contain)
the circle of curvature at $q'$, because it reaches ${\bf p}$ while the circle
of curvature does not.
But all circles tangent at $q'$ that are larger than the circle of curvature
at $q'$ must lie on one side of the curve in the neighborhood of $q'$
\cite[p. 176]{H52} and consequently $C_q$ must contain some points of the curve
in its interior.
We conclude that $q$ is not on the bisector (Remark~\ref{rmk:bis}).
\QED

Since the definition of an active point depends on the side of the tangent
(at $q'$) that ${\bf p}$ and the circle of curvature lie on, 
we are interested in points where this can change.

\begin{dfn}
\label{d:trim}
A point ${\bf r}(u_{0})$ of a curve is an {\bf inflection} point
if it is not a self-intersection or a cusp, and the tangent at 
${\bf r}(u_{0})$ intersects the curve three or more times at ${\bf r}(u_{0})$.
% concavity of the curve changes at this point
A point of the curve ${\bf r}(u)$ is a {\bf class}
point if its tangent intersects the point ${\bf p}$.\footnote{This
	term is chosen in allusion to the class of a curve, which is the
	number of tangents that hit a typical point not on the curve.}
A point of the curve ${\bf r}(u)$ is a {\bf circular} point
if its circle of curvature intersects ${\bf p}$.
Equivalently, a point ${\bf r}(u_{0})$ is circular 
if its center of curvature is ${\bf b}(u_{0})$.
\end{dfn}

We have already encountered class points: they are the points of the curve 
associated with points at infinity on the untrimmed bisector 
(Section~\ref{sec:untrim}).

\begin{thm}
\label{thm:active}
For a regular polynomial or rational curve or curve segment
${\bf r}(u)$ defined on the interval
$u \in I$, and a point ${\bf p}$ not on ${\bf r}(u)$, 
let ${\bf b}(u)$ be the untrimmed bisector of ${\bf p}$ and ${\bf r}(u)$,
and let $\{i_{1},\ldots,i_{M}\}$ be the ordered set of parameter values on $I$
that correspond to inflection points, class points, and circular points
of ${\bf r}(u)$.
Then, denoting the end points of $I$ by $i_{0}$ and $i_{M+1}$, we have
either
\be
{\bf b}(t) {\rm \ is\ active\ } \quad {\rm for\ all\ } t \in (i_k,i_{k+1})
\ee
or
\be
{\bf b}(t) {\rm \ is\ not\ active\ } \quad {\rm for\ all\ } t \in (i_k,i_{k+1})
\ee
on each span $(i_k,i_{k+1})$ for $k=0,\ldots,M$.
\end{thm}
\prf
Consider moving a point $q$ smoothly along the untrimmed bisector
({\em i.e.}, such that the parameter value changes smoothly).
By definition, in order to change from an active point to an inactive point,
or vice versa, one of the following must occur:
${\bf p}$ must move to a different side of the tangent at $q'$,
the circle of curvature at $q'$ must move to a different side of the tangent
at $q'$, or ${\bf p}$ must move to a different side of the circle of curvature
at $q'$ ({\em i.e.}, from inside to outside or vice versa).
The points associated with these occurrences are, respectively, 
the class points, inflection points, and circular points.
Therefore, if $q$ does not pass through a point with parameter value associated
with one of these special points, its active/inactive status will not change.
\QED

In order to make the second (and final) refinement from active segments 
to segments on the bisector,
recall that a point $q$ of the untrimmed bisector is in the bisector
if and only if its associated circle $C_q$ is empty.
A boundary between the bisector and the rest of the untrimmed bisector
is marked by a transition from points with empty circles to points 
with non-empty circles.
These transitions are associated with critical points.

\begin{dfn}
\label{d:cri}
A point ${\bf b}(u_{0})$ of the untrimmed bisector is a {\bf critical} point 
if the circle ${\bf C}_{{\bf b}(u_0)}$
is tangent to ${\bf r}(u)$ at two or more points (Figure~\ref{fig:critical}).
\end{dfn}

% FIGURE: \figg{fig:critical}{}{.5in}

Although defined differently, critical points are actually self-intersections
of the untrimmed bisector.

\begin{propn}
\label{prop:cri}
A point ${\bf b}(u_0)$ of the untrimmed bisector is a
critical point if and only if it is a self-intersection of ${\bf b}(u)$.
\end{propn}

\prf Let ${\bf q} \in {\bf b}(u)$ be a critical point, and let 
the circle ${\bf C}_{\bf q}$
be tangent to ${\bf r}(u)$ at the two points ${\bf r}(u_1)$ and ${\bf r}(u_2)$.
The normal at ${\bf r}(u_1)$ intersects the center of 
${\bf C}_{\bf q}$ and, since both ${\bf r}(u_1)$
and ${\bf p}$ lie on the boundary of this circle, a point of 
the normal is equidistant
from these two points at the center (Figure~\ref{fig:critical}).
Thus, ${\bf b}(u_{1}) = {\bf q}$.
Similarly, ${\bf b}(u_{2}) = {\bf q}$; so ${\bf q}$ is a self-intersection
of ${\bf b}(u)$.

Let ${\bf b}(u_{1}) = {\bf b}(u_{2})$ be a self-intersection.
${\bf p}$, ${\bf r}(u_{1})$, and ${\bf r}(u_{2})$ are all equidistant from 
${\bf b}(u_{1})$.
Thus, the circle ${\bf C}_{{\bf b}(u_{1})}$
contains ${\bf r}(u_{1})$ and ${\bf r}(u_{2})$.
Moreover, since the normals at ${\bf r}(u_{1})$ and ${\bf r}(u_{2})$
intersect the center ${\bf b}(u_{1})$ of this circle,
the circle is also tangent to the curve at 
${\bf r}(u_{1})$ and ${\bf r}(u_{2})$.
\QED

Proposition~\ref{prop:cri} allows us to trim using self-intersections
while arguing the validity of this trim using critical points.

\begin{thm}
\label{thm:trim2}
For a regular polynomial or rational curve or curve segment
${\bf r}(u)$ defined on the interval
$u \in I$, and a point ${\bf p}$ not on ${\bf r}(u)$, 
let ${\bf b}(u)$ be the untrimmed bisector of ${\bf p}$ and ${\bf r}(u)$,
and let $\{i_{1},\ldots,i_{M}\}$ be the ordered set of parameter values on $I$
that correspond to endpoints of active segments on ${\bf b}(u)$ 
or self-intersections of ${\bf b}(u)$,
{\em i.e.}, ${\bf b}(i_j) = {\bf b}(i_k)$ for some $1 \leq j \neq k \leq M$.
On an active segment $(b(i_j), b(i_k))$, $i_{j} < i_{k}$,
% 	Let $i_{j} < i_{k}$ be the parameter values of the endpoints of an 
% 	active 	segment. Then, either
\be
{\bf b}(t) {\rm \ is\ on\ the\ bisector\ }
\quad {\rm for\ all\ } t \in (i_l,i_{l+1})
\ee
or
\be
{\bf b}(t) {\rm \ is\ not\ on\ the\ bisector\ }
\quad {\rm for\ all\ } t \in (i_l,i_{l+1})
\ee
on each span $(i_l,i_{l+1})$ for $l=j,\ldots,k-1$ between successive
self-intersections on the active segment.
\end{thm}

\prf
Let ${\bf b}(u_{1})$ and ${\bf b}(u_{2})$ be two points
on an active segment of the untrimmed bisector ($u_1 < u_2$),
neither of them self-intersections,
${\bf b}(u_{1})$ on the bisector but
${\bf b}(u_{2})$ not on the bisector.
We shall show that the segment ${\bf b}(u_1,u_2)$ between ${\bf b}(u_{1})$ 
and ${\bf b}(u_{2})$
must contain a self-intersection ({\em i.e.}, a critical point) $\alpha$.
In other words, if an active subsegment of ${\bf b}(u)$ does not contain a 
self-intersection, it either lies entirely on or entirely off the bisector.

Since ${\bf b}(u_{1})$ lies on the bisector,
$C_{{\bf b}(u_{1})}$ touches the curve at the point ${\bf r}(u_{1})$ 
corresponding to ${\bf b}(u_{1})$
{\em and} $C_{{\bf b}(u_{1})}$ is empty (Remark~\ref{rmk:bis}).
As a point $q$ moves along the untrimmed bisector from ${\bf b}(u_{1})$ 
towards ${\bf b}(u_{2})$,
the radius of the circle $C_q$ changes smoothly 
while maintaining contact with $p$,
and at all times the neighborhood of the corresponding point $q'$ lies
completely outside of $C_q$ (Remark~\ref{r:active}).
In order to leave the bisector, the circle $C_q$ must become full, {\em i.e.}, 
the curve must enter $C_q$ (Remark~\ref{rmk:bis}).
We also know that this eventually happens, because ${\bf b}(u_{2})$ 
is not on the bisector.
Since the curve in the neighborhood of $q'$ does not enter $C_q$ 
% this is important because otherwise in the limit the curve might touch
% {\em and} enter at $q'$, e.g., inflection.
and the curve is regular, 
the curve cannot enter $C_q$ at $q'$
and must first enter $C_q$ at $q'' \neq q'$.
In order to enter $C_q$, the curve must first become tangent to $C_q$, 
and this position of $q$ is a critical point of the untrimmed
bisector, since its circle has two points of tangency with the curve, one
at $q'$ and one at the point where the curve is about to enter the circle
(Figure~\ref{fig:critical}).
Thus, the segment ${\bf b}(u_1,u_2)$ contains a critical point.
\QED

\begin{rmk}
If the desired interpretation for the bisector of a point ${\bf p}$ 
and a curve segment $S = r(I)$ of ${\bf r}(u)$ is 
\be
	\{y\ |\ {\rm dist}(y,{\bf p}) = {\rm dist}(y,{\bf r}(u)) 
		{\rm \ and\ the\ closest\ point\ of\ } {\bf r}(u) 
		{\rm \ to \ } y {\rm \ lies\ on\ } S \}
\ee
rather than its usual meaning
\be
	\{y|{\rm \ dist}(y,{\bf p}) = 
	    {\rm \ dist}(y,S\}
\ee
then the statement of Theorem~\ref{thm:trim2} is unchanged except that,
rather than using self-intersections of the segment ${\bf b}(I)$ 
({\em i.e.}, self-intersections ${\bf b}(u_1) = {\bf b}(u_2)$
where $u_1, u_2 \in I$),
one should use all self-intersections of ${\bf b}(u)$ that lie on 
the segment ${\bf b}(I)$ 
({\em i.e.}, self-intersections ${\bf b}(u_1) = {\bf b}(u_2)$
where $u_1 \in I$ but $u_2$ need not lie on $I$).
\end{rmk}

We now have an algorithm for computing the bisector of a point
${\bf p}$ and a regular parametric curve ${\bf r}(u)$.

\begin{enumerate}
\item
	Compute the untrimmed bisector of ${\bf p}$ and ${\bf r}(u)$,
	using (\ref{varoffset}) and (\ref{du}).
	For the polynomial and rational curve, this untrimmed bisector
	is given by (\ref{pbsctr}) and (\ref{rbsctr}), respectively.
\item
	Find the inflection points, class points, and circular points 	
	of the curve ${\bf r}(u)$.
\item
	For each segment on the untrimmed bisector defined by these 
	special points, compare the distance of the midpoint of this
	segment from ${\bf p}$ and ${\bf r}(u)$ (using (\ref{distance2}))
	and discard the segment if these distances are not equal.
\item
	Find the self-intersections of the untrimmed bisector
	(using (\ref{Iresltnt})).
\item
	Split each remaining segment of the untrimmed bisector
	at these self-intersections, and for each of the resulting
	segments: compare the distance of the midpoint of this
	segment from ${\bf p}$ and ${\bf r}(u)$ (using (\ref{distance2}))
	and discard the segment if these distances are not equal.
	The remaining segments are the bisector.
\end{enumerate}

\subsection{Self--intersections}

We have seen that the untrimmed bisector of a point ${\bf p}$ and
a polynomial or rational curve ${\bf r}(u)$ of degree $n$ is a
rational curve ${\bf u}$ of degree $m=3n-1$ (if ${\bf r}(u)$ is
polynomial) or $m=4n-1$ (if ${\bf r}(u)$ is rational).

A self--intersection of the untrimmed bisector ${\bf b}(u)$ arises
when two or more distinct parameter values correspond to the same
geometric point on its locus (with this definition we include the
exceptional cases where ${\bf b}(u)$ ``touches'' itself among its
self--intersections).

In order to compute the self--intersections, we are interested in
identifying all parameter values $u$ that satisfy the vector equation
\be \label{selfint}
{\bf b}(u+\xi) \,=\, {\bf b}(u) \quad {\rm for\ some\ } \xi\not=0 \,.
\ee
Let $X_b(u)$, $Y_b(u)$, and $W_b(u)$ be the polynomials that give the
homogeneous coordinates of ${\bf b}(u)$, according to (\ref{pbsctr})
or (\ref{rbsctr}), as appropriate. Then we have:

\begin{propn}
Let polynomials $P_k(u)$ and $Q_k(u)$ be defined in terms of $X_b(u)$,
$Y_b(u)$, $W_b(u)$ and their $r$--th derivatives $X_b^{(r)}(u)$,
$Y_b^{(r)}(u)$, $W_b^{(r)}(u)$ by
\ba \label{pkandqk}
P_k(u) &=& {W_b(u)X_b^{(k+1)}(u)-W_b^{(k+1)}(u)X_b(u) \over (k+1)!} \,,
\nonumber \\
Q_k(u) &=& {W_b(u)Y_b^{(k+1)}(u)-W_b^{(k+1)}(u)Y_b(u) \over (k+1)!}
\ea
for $k=0,\ldots,m-1$. Then the parameter values that satisfy $(\ref
{selfint})$ coincide with the roots of the polynomial $I(u)$ defined
by the determinant
\be \label{Iresltnt}
I \,=\, \left|\, \matrix{
 P_0 &P_1 &\cdot &\cdot &P_{m-1} &{} &{} &{} \cr
 {} &P_0 &P_1 &\cdot &\cdot &P_{m-1} &{} &{} \cr
 {} &{} &\cdot &\cdot &\cdot &\cdot &\cdot &{} \cr
 {} &{} &{} &P_0 &P_1 &\cdot &\cdot &P_{m-1} \cr
 Q_0 &Q_1 &\cdot &\cdot &Q_{m-1} &{} &{} &{} \cr
 {} &Q_0 &Q_1 &\cdot &\cdot &Q_{m-1} &{} &{} \cr
 {} &{} &\cdot &\cdot &\cdot &\cdot &\cdot &{} \cr
 {} &{} &{} &Q_0 &Q_1 &\cdot &\cdot &Q_{m-1} \cr } \,\right| \,.
\ee
\end{propn}

\prf Equation (\ref{selfint}) corresponds to the simultaneous scalar
equations
\ba \label{pandq}
P(u,\xi) &=&
{W_b(u)X_b(u+\xi)-W_b(u+\xi)X_b(u) \over \xi} \,=\, 0 \nonumber \\
Q(u,\xi) &=&
{W_b(u)Y_b(u+\xi)-W_b(u+\xi)Y_b(u) \over \xi} \,=\, 0
\ea
where the division by $\xi$ eliminates the trivial solution $\xi=0$ to
the numerators of expressions (\ref{pandq}), which does not correspond
to a self--intersection. Now by expanding $X_b(u+\xi)$, $Y_b(u+\xi)$,
$W_b(u+\xi)$ as (terminating) Taylor series in $\xi$, we can re--write
$P(u,\xi)$ and $Q(u,\xi)$ as polynomials of degree $m-1$ in $\xi$ whose
coefficients are the polynomials (\ref{pkandqk}) in $u$:
\be \label{pandq2}
P(u,\xi) \,=\, \sum_{k=0}^{m-1} P_k(u)\,\xi^k
\quad {\rm and} \quad
Q(u,\xi) \,=\, \sum_{k=0}^{m-1} Q_k(u)\,\xi^k \,.
\ee
Thus, we are interested in the values of $u$ at which the polynomials
(\ref{pandq2}) have a common root $\xi$. It is well known (see, for
example, \cite{uspensky48}) that the vanishing of the ``resultant''
of these polynomials with respect to $\xi$ expresses a sufficient and
necessary condition for them to have a common root. This resultant,
which we write symbolically as
\be \label{Pslfint}
I(u) \,=\, {\rm Resultant}_\xi (\,P(u,\xi),Q(u,\xi)\,) \,,
\ee
is a polynomial expression in the coefficients $P_k(u)$ and $Q_k(u)$
in (\ref{pandq2}), i.e., it is a polynomial $I(u)$ in $u$. Equation
(\ref{Iresltnt}) expresses this resultant as a Sylvester determinant
in the polynomials $P_k(u)$ and $Q_k(u)$, one of several equivalent
determinantal forms for the resultant. \QED

\begin{exmpl}
{\rm
Consider the ``self--intersection'' polynomial (\ref{Pslfint}) for
the case of Example \ref{offsets}.1 --- i.e., the bisector of the
point ${\bf p}=(\alpha,\beta)$ and the parabola ${\bf r}(u)=(u,u^2)$.
} \QED
\end{exmpl}

\section{Concluding remarks}
\label{conclusion}

\begin{thebibliography}{99}

\bibitem{bruce84}
J.~W.~Bruce and P.~J.~Giblin (1984), {\it Curves and Singularities},
Cambridge University Press.

\bibitem{buck78}
R.~C.~Buck (1978) {\it Advanced Calculus}, Third edition, McGraw--Hill,
New York, 362--367.

\bibitem{coolidge59}
J.~L.~Coolidge (1959), {\it A Treatise on Algebraic Plane Curves},
Dover Publications, New York.

\bibitem{coxeter69}
H.~S.~M.~Coxeter (1969), {\it Introduction to Geometry}, Wiley,
New York.

\bibitem{docarmo76}
M.~P.~do~Carmo (1976), {\it Differential Geometry of Curves and
Surfaces}, Prentice--Hall, Englewood Cliffs, N.J.

\bibitem{eisenhart60}
L.~P.~Eisenhart (1960), {\it Coordinate Geometry}, Dover Publications,
New York (reprint).

\bibitem{farouki89}
R.~T.~Farouki (1989), Hierarchical segmentations of algebraic curves
and some applications, in {\it Mathematical Methods in CAGD}, T.~Lyche
and L.~L.~Schumaker (eds.), Academic Press.

\bibitem{farouki90a}
R.~T.~Farouki and C.~A.~Neff (1990), Analytic properties of plane
offset curves \CAGD{\bf 7}, 83--99.

\bibitem{farouki90b}
R.~T.~Farouki and C.~A.~Neff (1990), Algebraic properties of plane
offset curves, \CAGD{\bf 7}, 100--127.

\bibitem{farouki90c}
R.~T.~Farouki and T.~Sakkalis (1990), Pythagorean hodographs,
\IBMJRD{\bf 34}, 736--752.

\bibitem{farouki91a}
R.~T.~Farouki (1991), Pythagorean--hodograph curves in practical
use, in {\it Geometry Processing\/} (R.~E.~Barnhill, ed.), SIAM,
Philadelphia, to appear.

\bibitem{farouki91b}
R.~T.~Farouki (1991), Watch your (parametric) speed! {\it The
Mathematics of Surfaces IV\/} (A.~Bowyer, ed.), Oxford University
Press, to appear.

\bibitem{H52}
D.~Hilbert and S.~Cohn-Vossen (1952),
{\it Geometry and the Imagination},
Chelsea, New York.

\bibitem{hoschek85}
J.~Hoschek (1985), Offset curves in the plane, \CAD{\bf 17}, 77--82.

\bibitem{hoschek88}
J.~Hoschek (1988), Spline approximation of offset curves, \CAGD{\bf 5},
33--40.

\bibitem{hoschek88b}
J.~Hoschek and N.~Wissel (1988), Optimal approximate conversion of
spline curves and spline approximation of offset curves, \CAD{\bf 20},
475--483.

\bibitem{kelly79}
P.~J.~Kelly and M.~L.~Weiss (1979), {\it Geometry and Convexity}, Wiley,
New York.

\bibitem{klass83}
R.~Klass (1983), An offset spline approximation for plane cubic
splines, \CAD{\bf 15}, 297--299.

\bibitem{kreyszig59}
E.~Kreyszig (1959), {\it Differential Geometry}, University of
Toronto Press.

\bibitem{leibniz92}
G.~W.~Leibniz (1692), Generalia de natura linearum, anguloque
contactus et osculi provocationibus aliisque cognatis et eorum
usibus nonnullis, Acta eruditorum: cited in [Kreyszig 1959].

\bibitem{nackman91}
L.~R.~Nackman and V.~Srinivasan (1991), Bisectors of linearly
separable sets, \DCG{\bf ?}, to appear.

\bibitem{pham88}
B.~Pham (1988), Offset approximation of uniform B-splines,
\CAD{\bf 20}, 471--474.

\bibitem{preparata85}
F.~P.~Preparata and M.~I.~Shamos (1985), {\it Computational
Geometry}, Springer, New York.

\bibitem{salmon79}
G.~Salmon (1879), {\it A Treatise on the Higher Plane Curves},
Chelsea, New York (reprint).

\bibitem{sederberg84}
T.~W.~Sederberg (1984), Degenerate parametric curves, \CAGD{\bf 1},
301--307.

\bibitem{sederberg86}
T.~W.~Sederberg (1986), Improperly parameterized rational curves,
\CAGD{\bf 3}, 67--75.

\bibitem{stoker69}
J.~J.~Stoker (1969), {\it Differential Geometry}, Wiley, New York.

\bibitem{tiller84}
W.~Tiller and E.~G.~Hanson (1984), Offsets of two-dimensional
profiles, \IEEECGA{\bf 4} (Sept.), 36--46.

\bibitem{uspensky48}
J.~V.~Uspensky (1948), {\it Theory of Equations}, McGraw--Hill,
New York.

\bibitem{W50}
R. J. Walker (1950),
{\it Algebraic Curves},
Springer--Verlag, New York.

\bibitem{winger62}
R.~M.~Winger (1962), {\it An Introduction to Projective Geometry},
Dover Publications, New York.

\bibitem{yap87}
C.--K.~Yap (1987), An ${\rm O}(n\log n)$ algorithm for the Voronoi
diagram of a set of simple curve segments, \DCG{\bf 2}, 365--393.

\bibitem{yap89}
C.--K.~Yap and H.~Alt (1989), Motion planning in the {\it
CL\/}--Environment, in {\it Lecture notes in computer science 382},
F.~Dehne, J.--R.~Sack, and N.~Santoro (eds.), Springer, New York,
373--380 (Proceedings of the Workshop on Algorithms and Data
Structures WADS~'89, Ottawa, Canada, August 17--19, 1989).

\end{thebibliography}

\section*{Figure captions}

\bigskip
\noindent{\bf Figure 1}:
Representative bisectors of a point and a circle: the bisector is
an ellipse, a straight line, or a hyperbola according to whether the
point lies inside, on, or outside the circle.

\medskip
\noindent{\bf Figure 2}:
Examples of the untrimmed bisector of a point and a parabola.

\medskip
\noindent{\bf Figure 3}:
Uuntrimmed bisectors of a point and an ellipse.

\figg{fig:du}{}{.1in}

\figg{fig:sec}{}{.1in}

\figg{fig:bis}{}{.1in}

\figg{fig:notclosest}{}{.1in}

\figg{fig:active}{}{.1in}

\figg{fig:critical}{}{.1in}

\end{document}

